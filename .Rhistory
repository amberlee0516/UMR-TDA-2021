select(SHEETBAR, DATE, LONGITUDE, LATITUDE, TP, TN) %>%
head(100)
water20 %>%
select(SHEETBAR, DATE, LONGITUDE, LATITUDE) %>%
groupby(SHEETBAR, DATE, LONGITUDE, LATITUDE) %>%
summarize(count = n()) %>%
filter(count > 1)
water20 %>%
select(SHEETBAR, DATE, LONGITUDE, LATITUDE) %>%
group_by(SHEETBAR, DATE, LONGITUDE, LATITUDE) %>%
summarize(count = n()) %>%
filter(count > 1)
water20 %>%
select(SHEETBAR, DATE, LONGITUDE, LATITUDE) %>%
group_by(SHEETBAR, DATE, LONGITUDE, LATITUDE) %>%
summarize(count = n()) %>%
filter(count > 2)
water20 %>% filter(DATE = "03/09/1993")
water20 %>% filter(DATE == "03/09/1993")
water20 %>%
select(SHEETBAR, DATE, LONGITUDE, LATITUDE) %>%
group_by(SHEETBAR, DATE, LONGITUDE, LATITUDE) %>%
summarize(count = n()) %>%
filter(count > 2)
water20 %>%
select(SHEETBAR, DATE, LONGITUDE, LATITUDE) %>%
group_by(SHEETBAR, DATE, LONGITUDE, LATITUDE) %>%
summarize(count = n()) %>%
filter(count > 3)
water20 %>% filter(DATE == "01/11/2007")
water20 %>%
select(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
group_by(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
summarize(count = n()) %>%
filter(count > 1)
water20 %>% filter(DATE == "	06/11/1993")
water20 %>% filter(DATE == "06/11/1993")
water20 %>% select(SHEETBAR, TN) %>% group_by(SHEETBAR, TN) %>% summarize(count = n()) %>% filter(count > 1)
water20 %>% select(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
group_by(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
summarize(count = n()) %>%
filter(count > 1)
water20 %>% select(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
group_by(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
summarize(count = n()) %>%
filter(count > 1)
water
water20 %>% head()
water20 %>% select(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
group_by(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
summarize(count = n()) %>%
filter(count > 6)
water20 %>% filter(SHEETBAR == "41015924")
water20 %>%
filter(CALCZCD == "SF") %>%
select(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
group_by(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
summarize(count = n()) %>%
filter(count > 6)
water20 %>%
filter(CALCZCD == "SF") %>%
select(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
group_by(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
summarize(count = n()) %>%
filter(count > 1)
water20 %>% filter(SHEETBAR == "-4603290")
water20 %>%
filter(SAMPZCD == "SF") %>%
select(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
group_by(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
summarize(count = n()) %>%
filter(count > 1)
water20 %>% filter(SHEETBAR == "--4303746")
water20 %>% filter(SHEETBAR == "-4303746")
water20 %>%
filter(SAMPZCD != CALCZCD) %>%
select(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
group_by(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
summarize(count = n()) %>%
filter(count > 1)
water20 %>% distinct(SHEETBAR)
water20 %>% distinct(SHEETBAR) %>% dim()
water20 %>% distinct(SHEETBAR) %>% dim()[1]
water20 %>% distinct(SHEETBAR) %>% dim()
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
water20 <- read.csv(file = "/pool data/ltrm_water_data_lat_long.csv")
library(tidyverse)
library(ggplot2)
library(lubridate)
library(corrplot)
library(RColorBrewer)
water20 <- read.csv(file = "/pool data/ltrm_water_data_lat_long.csv")
water20 <- read.csv(file = "/pool data/ltrm_water_data_lat_long.csv")
water20 <- read.csv(file = "pool data/ltrm_water_data_lat_long.csv")
setwd("~/Documents/GitHub/UMR-TDA-2021")
water20 <- read.csv(file = "pool data/ltrm_water_data_lat_long.csv")
water20 <- read.csv(file = "pools EDA/pool data/ltrm_water_data_lat_long.csv")
dim(water20)
dim(water20 %>% distinct(SHEETBAR))
dim(water20)[1] # number of observations
dim(water20 %>% distinct(SHEETBAR))[1] # number of distinct bar codes
dim(water20 %>% filter)
water20 %>% filter(SAMPZCD != CALCZCD) %>% count()
dim(water20 %>% filter(SAMPZCD != CALCZCD))[1]
dim(water20 %>% filter(SAMPZCD != CALCZCD) %>% distinct(SHEETBAR))[1]
water20 %>% filter(SAMPZCD != CALCZCD)
water20 %>%
filter(SAMPZCD != CALCZCD) %>% distinct(SHEETBAR)
water20 %>%
filter(SAMPZCD != CALCZCD) %>%
distinct(SHEETBAR)
water20 %>%
filter(SAMPZCD != CALCZCD)
table(water20$SAMPZCD)
table(water20$CALCZCD)
data.frame(table(water20$SAMPZCD))
water20 %>%
group_by(SAMPZCD) %>%
summarize(count = n())
water20 %>%
group_by(SAMPZCD, CALCZCD) %>%
summarize(count = n())
water20 %>%
group_by(SAMPZCD, CALCZCD) %>%
summarize(count = n()) %>%
pivot_wider(CALCZCD)
water20 %>%
group_by(SAMPZCD, CALCZCD) %>%
summarize(count = n()) %>%
pivot_wider(names_from = CALCZCD)
water20 %>%
group_by(SAMPZCD, CALCZCD) %>%
summarize(count = n()) %>%
pivot_wider(col = CALCZCD, names_from = CALCZCD)
?pivot_wider
water20 %>%
group_by(SAMPZCD, CALCZCD) %>%
summarize(count = n())
water20 %>%
group_by(SAMPZCD, CALCZCD) %>%
summarize(count = n()) %>%
pivot_wider(names_from = CALCZCD, values_from = count)
water20 %>%
group_by(SAMPZCD, CALCZCD) %>%
summarize(count = n())
water20 %>%
group_by(SAMPZCD, CALCZCD) %>%
summarize(count = n()) %>%
pivot_wider(names_from = CALCZCD, values_from = count)
water20 %>%
group_by(SAMPZCD, CALCZCD) %>%
summarize(count = n()) %>%
pivot_wider(names_from = CALCZCD, values_from = count,
names_repair = "check_unique")
water20 %>%
group_by(SAMPZCD, CALCZCD) %>%
summarize(count = n()) %>%
pivot_wider(names_from = CALCZCD, values_from = count)
water20 %>%
group_by(SAMPZCD, CALCZCD) %>%
summarize(count = n())
water20 %>%
group_by(SAMPZCD, CALCZCD) %>%
summarize(count = n())
sum(water20 == "")
water20 <- read.csv(file = "pools EDA/pool data/ltrm_water_data_lat_long.csv")
sum(water20 == "")
water20 %>%
group_by(SAMPZCD, CALCZCD) %>%
summarize(count = n())
water20 %>%
filter(SAMPZCD == "")
apply(data1 == "", 1, all)                # Remove rows with only empty
apply(water20 == "", 1, all)                # Remove rows with only empty
sum(apply(water20 == "", 1, all))                # Remove rows with only empty
water20 %>%
filter(SAMPZCD == "") %>% dimension()
water20 %>%
filter(SAMPZCD == "") %>% dim()
water20 %>%
filter(CALCZCD == "") %>% dim()
dim(water20)[1] # number of observations
dim(water20 %>% distinct(SHEETBAR))[1] # number of distinct bar codes
dim(water20 %>% filter(SAMPZCD != CALCZCD)
%>% distinct(SHEETBAR))[1]
water20 %>%
group_by(SAMPZCD, CALCZCD) %>%
summarize(count = n())
water20 %>%
filter(SAMPZCD != CALCZCD) %>%
distinct(SHEETBAR)
(water20 %>%
filter(SAMPZCD == "") %>% dim())[1]
(water20 %>%
filter(CALCZCD == "") %>% dim())[1]
water20 %>%
group_by(SAMPZCD, CALCZCD) %>%
summarize(count = n()) %>%
pivot_wider(names_from = CALCZCD, values_from = count)
water20 %>%
group_by(SAMPZCD, CALCZCD) %>%
summarize(count = n()) %>%
pivot_wider(names_from = CALCZCD, values_from = count,
names_repair = "minimal")
water20 %>%
select(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
group_by(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
summarize(count = n()) %>%
filter(count > 1)
water20 %>%
select(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
group_by(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
summarize(count = n()) %>%
filter(count > 1) %>% dim()
duplicates <- water20 %>%
select(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
group_by(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
summarize(count = n())
count_n_duplicates <- function(n, df) {
return((df %>% filter(count > n) %>% dim())[1])
}
duplicates <- water20 %>%
select(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
group_by(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
summarize(count = n())
sapply(1:10, count_n_duplicates, df )
count_n_duplicates <- function(n, df) {
return((df %>% filter(count > n) %>% dim())[1])
}
sapply(1:10, count_n_duplicates, df )
sapply(1:10, count_n_duplicates, duplicates)
sapply(1:10, count_n_duplicates, duplicates) %>% plot()
sapply(1:10, count_n_duplicates, duplicates) %>% plot(x = 1:10)
return((df %>% filter(count > n) %>% dim())[1]/204305)
duplicates <- water20 %>%
select(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
group_by(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
summarize(count = n())
duplicates <- water20 %>%
select(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
group_by(SHEETBAR, TIME, DATE, LONGITUDE, LATITUDE) %>%
summarize(count = n())
count_n_duplicates <- function(n, df) {
return((df %>% filter(count > n) %>% dim())[1]/204305)
}
count_n_duplicates <- function(n, df) {
return((df %>% filter(count > n) %>% dim())[1]/204305)
}
sapply(1:10, count_n_duplicates, duplicates) %>% plot(x = 1:10)
duplicates <- water20 %>%
select(SHEETBAR) %>%
group_by(SHEETBAR) %>%
summarize(count = n())
duplicates <- water20 %>%
select(SHEETBAR) %>%
group_by(SHEETBAR) %>%
summarize(count = n())
count_n_duplicates <- function(n, df) {
return((df %>% filter(count > n) %>% dim())[1]/204305)
}
count_n_duplicates <- function(n, df) {
return((df %>% filter(count > n) %>% dim())[1]/204305)
}
sapply(1:10, count_n_duplicates, duplicates) %>% plot(x = 1:10)
water20 %>%
group_by(SAMPZCD, CALCZCD) %>%
summarize(count = n())
(water20 %>%
filter(SAMPZCD == "") %>% dim())[1]
(water20 %>%
filter(CALCZCD == "") %>% dim())[1]
View(duplicates)
count_n_duplicates <- function(n, df) {
return((df %>% filter(count == n) %>% dim())[1]/204305)
}
sapply(1:10, count_n_duplicates, duplicates) %>% plot(x = 1:10)
count_duplicates <- data.frame(proportion = sapply(1:10, count_n_duplicates,
duplicates),
number_duplicates = 1:10)
count_duplicates
ggplot(count_duplicates) +
geom_point()
ggplot(count_duplicates, aes(x = number_duplicates, y = proportion)) +
geom_point()
count_duplicates
ggplot(count_duplicates, aes(x = number_duplicates, y = proportion)) +
geom_point() +
geom_vline(xintercept = 7)
dim(water20 %>% distinct(SHEETBAR))[1] # number of distinct bar codes
count_n_duplicates <- function(n, df) {
return((df %>% filter(count == n) %>% dim())[1]/156474)
}
count_duplicates <- data.frame(proportion = sapply(1:10, count_n_duplicates,
duplicates),
number_duplicates = 1:10)
ggplot(count_duplicates, aes(x = number_duplicates, y = proportion)) +
geom_point() +
geom_vline(xintercept = 7)
count_duplicates
ggplot(count_duplicates, aes(x = number_duplicates, y = proportion)) +
geom_bar(stat = "identity") +
geom_vline(xintercept = 7)
count_duplicates
sum(count_duplicates$proportion)
count_duplicates
round(count_duplicates$proportion, digits = 4)
TURBQF
water20 %>% head()
water20 %>% head()
water20 %>% names()
water20 %>% select(TURBQF)
water20 %>% select(TURBQF)%>% distinct9)
water20 %>% select(TURBQF)%>% distinct()
water20 %>% group_by(SHEETBAR, STRATUM) %>% summarize(count = n()) %>%
filter(count > 1)
water20 %>% filter(CALCZCD == "SF")
paste(water_var, "ZCD")
water_var <- c('TN','TP','TEMP','DO','TURB',
'COND','VEL','SS','WDP','CHLcal','SECCHI')
paste(water_var, "ZCD")
paste(water_var, "ZCD", sep = "")
waterQF_var <- paste(water_var, "QF", sep = "")
water20 %>% select(all_of(water_var), all_of(waterQF_var))
(water20 %>%
filter(SAMPZCD == "") %>% dim())[1]
(water20 %>%
filter(CALCZCD == "") %>% dim())[1]
water20 %>%
filter(CALCZCD == "SF") %>%
group_by(SHEETBAR) %>%
summarize(count = n()) %>%
filter(count > 1)
(water20 %>%
filter(CALCZCD == "") %>% dim())[1]
water20 %>%
filter(CALCZCD == "SF") %>%
group_by(SHEETBAR) %>%
summarize(count = n()) %>%
filter(count > 1) %>%
pull()
water20 %>%
filter(CALCZCD == "SF") %>%
group_by(SHEETBAR) %>%
summarize(count = n()) %>%
filter(count > 1) %>%
select(SHEETBAR) %>%
pull()
water20 %>% filter(SHEETBAR %in% dup_sf_sheetbar)
dup_sf_sheetbar
dup_sf_sheetbar <- water20 %>%
filter(CALCZCD == "SF") %>%
group_by(SHEETBAR) %>%
summarize(count = n()) %>%
filter(count > 1) %>%
select(SHEETBAR) %>%
pull()
water20 %>% filter(SHEETBAR %in% dup_sf_sheetbar)
water20 %>% filter(SHEETBAR %in% dup_sf_sheetbar) %>%
select(SHEETBAR, TP, TPQF, TNQF)
water20 %>% filter(SHEETBAR %in% dup_sf_sheetbar) %>%
select(SHEETBAR, TP, TPQF, TN, TNQF)
water20 %>% filter(SHEETBAR %in% dup_sf_sheetbar) %>%
select(SHEETBAR, TP, TPQF, TN, TNQF, DO, DOQF)
water20 %>% filter(SHEETBAR %in% dup_sf_sheetbar, CALCZCD == "SF") %>%
select(SHEETBAR, TP, TPQF, TN, TNQF, DO, DOQF)
water20 %>% filter(SHEETBAR %in% dup_sf_sheetbar & CALCZCD == "SF") %>%
select(SHEETBAR, TP, TPQF, TN, TNQF, DO, DOQF)
water20 %>%
filter(CALCZCD == "SF")
water20 %>% filter(CALCZCD == "")
(water20 %>%
filter(CALCZCD == "") %>% dim())[1]
water20 %>%
filter(CALCZCD == "SF") %>%
group_by(SHEETBAR) %>%
summarize(count = n()) %>%
filter(count > 1)
water20 %>% filter(SHEETBAR %in% dup_sf_sheetbar & CALCZCD == "SF") %>%
select(SHEETBAR, TP, TPQF, TN, TNQF, DO, DOQF)
water20 %>% filter(SHEETBAR == 47000678) # ALL EMPTY LOL
dim(water20 %>% filter(CALCZCD == ""))[1]
dim(water20 %>% filter(is.na(CALCZCD)))[1]
water20 %>% filter(SHEETBAR %in% dup_sf_sheetbar & CALCZCD == "SF") %>%
select(SHEETBAR, all_of(water_var))
ggplot(count_duplicates, aes(x = number_duplicates, y = proportion)) +
geom_bar(stat = "identity") +
geom_vline(xintercept = 7)
count_duplicates
count_duplicates <- data.frame(proportion = sapply(1:8, count_n_duplicates,
duplicates),
number_duplicates = 1:8)
ggplot(count_duplicates, aes(x = number_duplicates, y = proportion)) +
geom_bar(stat = "identity") +
geom_vline(xintercept = 7)
count_duplicates
duplicates
duplicates %>% head()
water20 %>%
filter(SHEETBAR == -4604347)
water20 %>%
filter(SHEETBAR == -4604347) %>%
select(SHEETBAR, Z, CALCZCD, DO, TP, TN)
water20 %>%
filter(SHEETBAR == -4604347) %>%
select(SHEETBAR, Z, CALCZCD, DO, TP, TN)
water20 %>%
filter(SHEETBAR == -4604346) %>%
select(SHEETBAR, Z, CALCZCD, DO, TP, TN)
water20 %>%
filter(SHEETBAR == -4604345) %>%
select(SHEETBAR, Z, CALCZCD, DO, TP, TN)
duplicates %>% filter(count > 4)
water20 %>%
filter(SHEETBAR == 41015929	) %>%
select(SHEETBAR, Z, CALCZCD, DO, TP, TN)
dim(water20 %>% distinct(SHEETBAR))[1]
204305-156474
(204305-156474)/204305
table(water20$CALCZCD)
water_var
water_var <- c('TN','TP','TEMP','DO','TURB',
'COND','VEL','SS','WDP','CHLcal','SECCHI')
waterQF_var <- paste(water_var, "QF", sep = "")
water_var <- c('SHEETBAR', 'DATE', 'LATITUDE', 'LONGITUDE', water_var)
147/204
table(water20$CALCZCD, water20$var)
for (var in water_var){
table(water20$CALCZCD, water20$var)
}
identifier_var <- c('SHEETBAR', 'DATE', 'LATITUDE', 'LONGITUDE')
table(water20$calczcd, water20$TN)
prop.table(water20$calczcd, water20$TN)
table(water20$CALCZCD, water20$TN)
water20 %>%
select(all_of(water_var), CALCZCD)
water_var <- c('TN','TP','TEMP','DO','TURB',
'COND','VEL','SS','WDP','CHLcal','SECCHI')
water20 %>%
select(all_of(water_var), CALCZCD)
water20 %>%
select(all_of(water_var), CALCZCD) %>%
colSums(is.na())
water20 %>%
select(all_of(water_var), CALCZCD)
sum(is.na(water20$CHLcal))
sum(is.na(water20[CALCZCD == "SF"]$CHLcal))
sum(is.na(water20[water20$CALCZCD == "SF"]$CHLcal))
water20[water20$CALCZCD == "SF"]
water20[(water20$CALCZCD) == "SF"]
water20[(water20$CALCZCD) = "SF"]
filterwater <- water20 %>%
filter(CALCZCD == "SF") %>%
select(all_of(water_var))
sapply(filterwater, function(x) sum(is.na(x)))
dim(filterwater)
sapply(filterwater, function(x) sum(is.na(x)/147171))
water20 %>%
filter(CALCZCD == "SF") %>%
select(all_of(c(water_var, waterQF_var, identifier_var))) %>%
filter_at(vars(contains("QF")), all_vars(. != 8))
waterQF_var
waterQF_var[waterQF_var != "WDPQF" & waterQF_var != "CHLcalQF"]
waterQF_var <- c(waterQF_var, "ZMAXQF")
water20 %>%
filter(CALCZCD == "SF") %>%
select(all_of(c(water_var, waterQF_var, identifier_var))) %>%
filter_at(vars(contains("QF")), all_vars(. != 8))
waterQF_var <- waterQF_var[waterQF_var != "WDPQF" &
waterQF_var != "CHLcalQF"]
waterQF_var <- c(waterQF_var, "ZMAXQF")
water20 %>%
filter(CALCZCD == "SF") %>%
select(all_of(c(water_var, waterQF_var, identifier_var))) %>%
filter_at(vars(contains("QF")), all_vars(. != 8))
water20 %>%
filter(CALCZCD == "SF") %>%
select(all_of(c(identifier_var), water_var, waterQF_var)) %>%
filter_at(vars(contains("QF")), all_vars(. != 8))
water20 %>%
filter(CALCZCD == "SF") %>%
select(all_of(c(identifier_var, water_var, waterQF_var))) %>%
filter_at(vars(contains("QF")), all_vars(. != 8))
water20 %>%
filter(CALCZCD == "") %>%
water20 %>%
filter(CALCZCD == "") %>%
dim()
water20 %>%
filter(CALCZCD == "") %>%
water20 %>%
filter(CALCZCD == "") %>%
dim()
(water20 %>%
filter(CALCZCD == "") %>%
dim())[1]
water20 %>%
filter(CALCZCD == "SF") %>%
select(all_of(c(identifier_var, water_var, waterQF_var))) %>%
filter_at(vars(contains("QF")), all_vars(. != 8)) %>% # forrest, edit this
head()
dim(filterwater)
filterwater <- water20 %>%
filter(CALCZCD == "SF") %>%
select(all_of(c(identifier_var, water_var, waterQF_var))) %>%
filter_at(vars(contains("QF")), all_vars(. != 8)) # forrest, edit this
filterwater %>% head()
dim(filterwater)
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
filterwater <- water20 %>%
filter(CALCZCD == "SF") %>%
select(all_of(c(identifier_var, water_var, waterQF_var)))
filterwater
