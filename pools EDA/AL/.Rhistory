pivot_longer(water_var, names_to = "Variables") %>%
ggplot(aes(x = year, y = value)) +
geom_point(aes(color = Variables)) +
geom_line(aes(color = Variables)) +
ggtitle("Number of missing values per year",
subtitle = "Of selected variables (color coded) in Pool 4 Lower") +
scale_fill_manual(values = brewer.pal(11,'Blues'))
water_4L %>%
group_by(year) %>%
summarise(across(water_var, ~ sum(is.na(.x)))) %>%
pivot_longer(water_var, names_to = "Variables") %>%
ggplot(aes(x = year, y = value)) +
geom_point(aes(color = Variables)) +
geom_line(aes(color = Variables)) +
ggtitle("Number of missing values per year",
subtitle = "Of selected variables (color coded) in Pool 4 Lower") +
scale_color_manual(values = brewer.pal(11,'Blues'))
scale_color_brewer('Set3)
water_4L %>%
select(year, all_of(c("TN", "TURB", "SS", "CHLcal"))) %>%
group_by(year) %>%
summarise(across(c("TN", "TURB", "SS", "CHLcal"), ~ sum(is.na(.x))) ) %>%
pivot_longer(c("TN", "TURB", "SS", "CHLcal"), names_to = "Variables") %>%
ggplot(aes(x = year, y = value)) +
geom_point(aes(color = Variables)) +
geom_line(aes(color = Variables)) +
facet_wrap(~ Variables) +
ggtitle("Number of missing values per year",
subtitle = "Of selected variables (color coded) in Pool 4 Lower")
water_4L
water_4L <- bind_cols(water_4L, missing = rowSums(is.na(water_4L)))
# data.frame(Variables = names(water_4L), Missing = colSums(is.na(water_4L))) %>%
#   filter(Variables %in% water_var) %>%
#   ggplot(aes(x = Variables, y = Missing)) +
#   geom_bar(stat = "identity")
water_4L %>%
group_by(year) %>%
summarise(across(water_var, ~ sum(is.na(.x)))) %>%
pivot_longer(water_var, names_to = "Variables") %>%
ggplot(aes(x = year, y = value)) +
geom_point(aes(color = Variables)) +
geom_line(aes(color = Variables)) +
ggtitle("Number of missing values per year",
subtitle = "Of selected variables (color coded) in Pool 4 Lower")
ggsave("missing_count_selected_pool4L.png")
water_4L %>%
select(year, all_of(c("TN", "TURB", "SS", "CHLcal"))) %>%
group_by(year) %>%
summarise(across(c("TN", "TURB", "SS", "CHLcal"), ~ sum(is.na(.x))) ) %>%
pivot_longer(c("TN", "TURB", "SS", "CHLcal"), names_to = "Variables") %>%
ggplot(aes(x = year, y = value)) +
geom_point(aes(color = Variables)) +
geom_line(aes(color = Variables)) +
facet_wrap(~ Variables) +
ggtitle("Number of missing values per year",
subtitle = "Of selected variables (color coded) in Pool 4 Lower")
ggsave("missing_count_4_pool4L.png")
ggplot(water_4L, aes(x = decade, y = missing)) +
geom_violin(aes(group = decade))
ggplot(water_4L, aes(x = decade, y = missing)) +
geom_violin(aes(group = decade))
water_4L
water_var <- c('TN','TP','TEMP','DO','TURB',
'COND','VEL','SS','WDP','CHLcal','SECCHI')
# filter for pool 4 lower
water_4L <- water20 %>%
filter(FLDNUM == "1") %>%
mutate(DATE = mdy(DATE),
year = year(DATE),
is_lower = case_when(LONGITUDE <= -92.33 ~ TRUE,
TRUE ~ FALSE),
decade = case_when(year <= 2000 ~ "1993-2000",
year >= 2001 & year <= 2014 ~ "2001-2014",
year >= 2014 ~ "2014-2020"),
Stratum = case_when(STRATUM == 1 ~ "Main channel",
STRATUM == 2 ~ "Side channel",
STRATUM == 3 ~ "Backwater area",
STRATUM == 4 ~ "Lake Pepin",
STRATUM == 5 ~ "Impounded",
STRATUM == 6 ~ "Isolated",
STRATUM == 7 ~ "New Terrestrial")) %>%
filter(is_lower & STRATUM != 4)
water_4L <- bind_cols(water_4L, missing = rowSums(is.na(water_4L)))
# data.frame(Variables = names(water_4L), Missing = colSums(is.na(water_4L))) %>%
#   filter(Variables %in% water_var) %>%
#   ggplot(aes(x = Variables, y = Missing)) +
#   geom_bar(stat = "identity")
water_4L %>%
group_by(year) %>%
summarise(across(water_var, ~ sum(is.na(.x)))) %>%
pivot_longer(water_var, names_to = "Variables") %>%
ggplot(aes(x = year, y = value)) +
geom_point(aes(color = Variables)) +
geom_line(aes(color = Variables)) +
ggtitle("Number of missing values per year",
subtitle = "Of selected variables (color coded) in Pool 4 Lower")
ggsave("missing_count_selected_pool4L.png")
water_4L %>%
select(year, all_of(c("TN", "TURB", "SS", "CHLcal"))) %>%
group_by(year) %>%
summarise(across(c("TN", "TURB", "SS", "CHLcal"), ~ sum(is.na(.x))) ) %>%
pivot_longer(c("TN", "TURB", "SS", "CHLcal"), names_to = "Variables") %>%
ggplot(aes(x = year, y = value)) +
geom_point(aes(color = Variables)) +
geom_line(aes(color = Variables)) +
facet_wrap(~ Variables) +
ggtitle("Number of missing values per year",
subtitle = "Of selected variables (color coded) in Pool 4 Lower")
ggsave("missing_count_4_pool4L.png")
ggplot(water_4L, aes(x = decade, y = missing)) +
geom_violin(aes(group = decade))
ggsave("missing_violin_pool4L.png")
ggplot(water_4L, aes(x = decade, y = missing)) +
geom_violin(aes(group = decade), fill = "blue") +
ggsave("missing_violin_pool4L.png")
brewer.pal(7,'Blues')[3]
geom_violin(aes(group = decade), fill = #9ECAE1) +
ggplot(water_4L, aes(x = decade, y = missing)) +
geom_violin(aes(group = decade), fill = "#9ECAE1")
ggplot(water_4L, aes(x = decade, y = missing)) +
geom_violin(aes(group = decade), fill = "#9ECAE1") +
ggtitle("Density of count of missing observations per decade",
subtitle = "Pool 4 Lower")
ggplot(water_4L, aes(x = decade, y = missing)) +
geom_violin(aes(group = decade, fill = decade)) +
ggtitle("Density of count of missing observations per decade",
subtitle = "Pool 4 Lower") +
scale_fill_manual(values = brewer.pal(7,'Blues')[3:6]) +
theme(legend.position = FALSE)
ggplot(water_4L, aes(x = decade, y = missing)) +
geom_violin(aes(group = decade, fill = decade)) +
ggtitle("Density of count of missing observations per decade",
subtitle = "Pool 4 Lower") +
scale_fill_manual(values = brewer.pal(7,'Blues')[3:6]) +
theme(legend.position = "none")
ggsave("missing_violin_pool4L.png")
ggsave("missing_violin_pool4L.png", height = "4in", width = "6in")
ggsave("missing_violin_pool4L.png", height = "4 in", width = "6 in")
ggsave("missing_violin_pool4L.png", height = 4, width = 6)
water_4L %>%
mutate(season = quarter(DATE)) %>%
ggplot(aes(x = year, y = CHLcal, group = year)) +
geom_boxplot() +
facet_wrap(~ season) +
coord_flip()
water_4L %>%
mutate(season = quarter(DATE)) %>%
ggplot(aes(x = year, y = CHLcal, group = year)) +
geom_boxplot(size = 0.5) +
facet_wrap(~ season)
water_4L %>%
mutate(season = quarter(DATE)) %>%
ggplot(aes(x = year, y = CHLcal, group = year)) +
geom_boxplot(size = 0.05) +
facet_wrap(~ season)
water_4L$LOCATCD
water_4L$FLDNUM
water_4L$LOCATCD
water_4L$FLDNUM
water_4L %>%
mutate(season = quarter(DATE)) %>%
ggplot(aes(x = year, y = TEMP, group = year)) +
geom_boxplot() +
facet_wrap(~ season)
5 %/% 6
5 %/% 4
water_4L %>%
mutate(quarter = quarter(DATE))
water_4L %>%
mutate(quarter = quarter(DATE)) %>% select(quarter, DATE)
water_4L %>%
mutate(quarter = month(DATE)) %>% select(quarter, DATE)
sum(is.na(water_4L$DATE))
water_4L %>%
mutate(month = month(DATE),
season = case_when(quarter >= 2 & quarter <= 4 ~ "Spring",
quarter >= 5 & quarter <= 7 ~ "Summer",
quarter >= 8 & quarter <= 10 ~ "Fall",
TRUE ~ "Winter")) %>%
ggplot(aes(x = year, y = TEMP, group = year)) +
geom_boxplot() +
facet_wrap(~ season) +
ggtitle("Temperature recordings by season")
water_4L %>%
mutate(month = month(DATE),
season = case_when(month >= 2 & month <= 4 ~ "Spring",
month >= 5 & month <= 7 ~ "Summer",
month >= 8 & month <= 10 ~ "Fall",
TRUE ~ "Winter")) %>%
ggplot(aes(x = year, y = TEMP, group = year)) +
geom_boxplot() +
facet_wrap(~ season) +
ggtitle("Temperature recordings by season")
water_4L %>%
mutate(month = month(DATE),
Season = case_when(month >= 2 & month <= 4 ~ "Spring",
month >= 5 & month <= 7 ~ "Summer",
month >= 8 & month <= 10 ~ "Fall",
TRUE ~ "Winter"),
Season = refactor(Season,
levs = c("Spring", "Summer", "Fall", "Winter"))) %>%
ggplot(aes(x = year, y = TEMP, group = year)) +
geom_boxplot() +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season")
water_4L %>%
mutate(month = month(DATE),
Season = case_when(month >= 2 & month <= 4 ~ "Spring",
month >= 5 & month <= 7 ~ "Summer",
month >= 8 & month <= 10 ~ "Fall",
TRUE ~ "Winter"),
Season = refactor(Season,
levs = c("Spring", "Summer", "Fall", "Winter")))
water_4L %>%
mutate(month = month(DATE),
Season = case_when(month >= 2 & month <= 4 ~ "Spring",
month >= 5 & month <= 7 ~ "Summer",
month >= 8 & month <= 10 ~ "Fall",
TRUE ~ "Winter"),
Season = as.factor(Season))
water_4L %>%
mutate(month = month(DATE),
Season = case_when(month >= 2 & month <= 4 ~ "Spring",
month >= 5 & month <= 7 ~ "Summer",
month >= 8 & month <= 10 ~ "Fall",
TRUE ~ "Winter"),
Season = as.factor(Season)) %>%
ggplot(aes(x = year, y = TEMP, group = year)) +
geom_boxplot() +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season")
water_4L %>%
mutate(month = month(DATE),
Season = case_when(month >= 2 & month <= 4 ~ "Spring",
month >= 5 & month <= 7 ~ "Summer",
month >= 8 & month <= 10 ~ "Fall",
TRUE ~ "Winter"),
Season = as.factor(Season,
levels = c("Spring", "Summer", "Fall", "Winter"))) %>%
ggplot(aes(x = year, y = TEMP, group = year)) +
geom_boxplot() +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season")
water_4L %>%
mutate(month = month(DATE),
Season = case_when(month >= 2 & month <= 4 ~ "Spring",
month >= 5 & month <= 7 ~ "Summer",
month >= 8 & month <= 10 ~ "Fall",
TRUE ~ "Winter"),
Season = as.factor(Season,
labels = c("Spring", "Summer", "Fall", "Winter"))) %>%
ggplot(aes(x = year, y = TEMP, group = year)) +
geom_boxplot() +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season")
`1` = "Spring",
`1` = "Spring",
water_4L %>%
mutate(month = month(DATE),
Season = case_when(month >= 2 & month <= 4 ~ "Spring",
month >= 5 & month <= 7 ~ "Summer",
month >= 8 & month <= 10 ~ "Fall",
TRUE ~ "Winter"),
Season = as_factor(Season,
labels = c(
`1` = "Spring",
`2` = "Summer",
`3` = "Fall",
`4` = "Winter"))) %>%
ggplot(aes(x = year, y = TEMP, group = year)) +
geom_boxplot() +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season")
levels =c(1, 2, 3, 4)) %>%
ggtitle("Temperature recordings by season")
water_4L %>%
mutate(month = month(DATE),
Season = case_when(month >= 2 & month <= 4 ~ "Spring",
month >= 5 & month <= 7 ~ "Summer",
month >= 8 & month <= 10 ~ "Fall",
TRUE ~ "Winter"),
Season = as_factor(Season,
levels =c(1, 2, 3, 4))) %>%
ggplot(aes(x = year, y = TEMP, group = year)) +
geom_boxplot() +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season")
seasonalwater <- water_4L %>%
mutate(month = month(DATE),
Season = case_when(month >= 2 & month <= 4 ~ "Spring",
month >= 5 & month <= 7 ~ "Summer",
month >= 8 & month <= 10 ~ "Fall",
TRUE ~ "Winter"))
seasonalwater$Season <- factor(seasonalwater$Season,
levels = c("Spring", "Summer",
"Fall", "Winter"))
ggplot(seasonalwater, aes(x = year, y = TEMP, group = year)) +
geom_boxplot() +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season")
ggplot(seasonalwater, aes(x = year, y = TEMP, group = year)) +
geom_boxplot(aes(fill = Season)) +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season")
ggplot(seasonalwater, aes(x = year, y = TEMP, group = year)) +
geom_boxplot(aes(color = Season)) +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season") +
theme(legend.position = "none")
ggplot(seasonalwater, aes(x = year, y = TEMP, group = year)) +
geom_boxplot(aes(color = Season)) +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season") +
theme(legend.position = "none") +
scale_color_brewer("Oranges")
ggplot(seasonalwater, aes(x = year, y = TEMP, group = year)) +
geom_boxplot(aes(color = Season)) +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season") +
theme(legend.position = "none") +
scale_color_brewer()
ggplot(seasonalwater, aes(x = year, y = TEMP, group = year)) +
geom_boxplot(aes(color = Season)) +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season") +
theme(legend.position = "none") +
scale_color_brewer("GnBu")
ggplot(seasonalwater, aes(x = year, y = TEMP, group = year)) +
geom_boxplot(aes(color = Season)) +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season") +
theme(legend.position = "none") +
scale_color_manual(palette = "GnBu")
ggplot(seasonalwater, aes(x = year, y = TEMP, group = year)) +
geom_boxplot(aes(color = Season)) +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season") +
theme(legend.position = "none") +
scale_color_brewer(palette = "GnBu")
ggplot(seasonalwater, aes(x = year, y = TEMP, group = year)) +
geom_boxplot(aes(color = Season)) +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season") +
theme(legend.position = "none") +
scale_color_brewer(palette = "PrGn")
ggplot(seasonalwater, aes(x = year, y = TEMP, group = year)) +
geom_boxplot(aes(color = Season)) +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season") +
theme(legend.position = "none") +
scale_color_brewer(palette = "Pastel")
ggplot(seasonalwater, aes(x = year, y = TEMP, group = year)) +
geom_boxplot(aes(color = Season)) +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season") +
theme(legend.position = "none") +
scale_color_brewer(palette = "BuGn")
ggplot(seasonalwater, aes(x = year, y = TEMP, group = year)) +
geom_boxplot(aes(color = Season)) +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season") +
theme(legend.position = "none") +
scale_color_brewer(values = brewer.pal(6, "BuGn")[2:6])
ggplot(seasonalwater, aes(x = year, y = TEMP, group = year)) +
geom_boxplot(aes(color = Season)) +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season") +
theme(legend.position = "none") +
scale_color_manuel(values = brewer.pal(6, "BuGn")[2:6])
ggplot(seasonalwater, aes(x = year, y = TEMP, group = year)) +
geom_boxplot(aes(color = Season)) +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season") +
theme(legend.position = "none") +
scale_color_manual(values = brewer.pal(6, "BuGn")[2:6])
ggplot(seasonalwater, aes(x = year, y = TEMP, group = year)) +
geom_boxplot(aes(color = Season)) +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season") +
theme(legend.position = "none") +
scale_color_manual(values = brewer.pal(6, "BuGn")[3:6])
ggplot(seasonalwater, aes(x = year, y = TEMP, group = year)) +
geom_boxplot(aes(color = Season)) +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season") +
theme(legend.position = "none") +
scale_color_manual(values = brewer.pal(6, "YlGnBu")[3:6])
ggplot(seasonalwater, aes(x = year, y = DO, group = year)) +
geom_boxplot(aes(color = Season)) +
facet_wrap(~ Season) +
ggtitle("Dissolved Oxygen recordings by season") +
theme(legend.position = "none") +
scale_color_manual(values = brewer.pal(6, "YlGnBu")[3:6])
ggplot(seasonalwater, aes(x = year, y = CHLcal, group = year)) +
geom_boxplot(aes(color = Season)) +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season") +
theme(legend.position = "none") +
scale_color_manual(values = brewer.pal(6, "YlGnBu")[3:6])
seasonalwater %>% filter(CHLcal <= 100)
seasonalwater %>% filter(CHLcal <= 100) %>%
ggplot(aes(x = year, y = CHLcal, group = year)) +
geom_boxplot(aes(color = Season)) +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season") +
theme(legend.position = "none") +
scale_color_manual(values = brewer.pal(6, "YlGnBu")[3:6])
sum(seasonalwater$CHLcal <= 100)
sum((seasonalwater$CHLcal <= 100), na.rm = T)
sum((seasonalwater$CHLcal >= 100), na.rm = T)
ggplot(seasonalwater, aes(x = year, y = TEMP, group = year)) +
geom_boxplot(aes(color = Season)) +
facet_wrap(~ Season) +
ggtitle("Temperature recordings by season") +
theme(legend.position = "none") +
scale_color_manual(values = brewer.pal(6, "YlGnBu")[3:6])
ggsave("seasonal_temperature_pool4L.png")
seasonalwater %>% filter(CHLcal <= 100) %>%
ggplot(aes(x = year, y = CHLcal, group = year)) +
geom_boxplot(aes(color = Season)) +
facet_wrap(~ Season) +
ggtitle("Chlorophyll A recordings by season",
subtitle = "With outlier measurements about 100 removed") +
theme(legend.position = "none") +
scale_color_manual(values = brewer.pal(6, "YlGnBu")[3:6])
ggsave("seasonal_chlorophyllA_pool4L.png")
plotter_box_by_year <- function(var_str, data, facet_bool){
# facet_bool gives if you should facet by STRATUM type
title <- paste(var_str, "boxplot_by_year", "pool4L", sep = "_")
if (facet_bool){title <- paste(title, "_facet")}
title <- paste(title, "png", sep = ".")
if (facet_bool){
data %>%
filter(!is.na(!!sym(var_str))) %>%
ggplot(aes(x = year, y = !!sym(var_str), group = year)) +
geom_boxplot() +
facet_wrap(~ STRATUM)
} else {
data %>%
filter(!is.na(!!sym(var_str))) %>%
ggplot(aes(x = year, y = !!sym(var_str), group = year)) +
geom_boxplot()
}
ggsave(title)
}
sapply(c("TN", "TURB", "SS", "CHLcal"), plotter_box_by_year, water_4L, F)
sapply(c("TN", "TURB", "SS", "CHLcal"), plotter_box_by_year, water_4L, T)
# SS, turbidity, and secchi all three measure water quality
# velocity graph is new
# dissolved oxygen is variable by the time of day
# temperature is important per season
# habitat class for these water quality data is all NA
# unique(water_4L$HABCLASS)
unique(water_4L$STRATUM)
table(water_4L$STRATUM)
plotter_box_by_year <- function(var_str, data, facet_bool){
# facet_bool gives if you should facet by STRATUM type
title <- paste(var_str, "boxplot_by_year", "pool4L", sep = "_")
if (facet_bool){title <- paste(title, "_facet")}
title <- paste(title, "png", sep = ".")
if (facet_bool){
data %>%
filter(!is.na(!!sym(var_str))) %>%
ggplot(aes(x = year, y = !!sym(var_str), group = year)) +
geom_boxplot() +
facet_wrap(~ STRATUM, nrow = 2)
} else {
data %>%
filter(!is.na(!!sym(var_str))) %>%
ggplot(aes(x = year, y = !!sym(var_str), group = year)) +
geom_boxplot()
}
ggsave(title)
}
sapply(c("TN", "TURB", "SS", "CHLcal"), plotter_box_by_year, water_4L, F)
sapply(c("TN", "TURB", "SS", "CHLcal"), plotter_box_by_year, water_4L, T)
# SS, turbidity, and secchi all three measure water quality
# velocity graph is new
# dissolved oxygen is variable by the time of day
# temperature is important per season
# habitat class for these water quality data is all NA
# unique(water_4L$HABCLASS)
unique(water_4L$STRATUM)
table(water_4L$STRATUM)
plotter_box_by_year <- function(var_str, data, facet_bool){
# facet_bool gives if you should facet by STRATUM type
title <- paste(var_str, "boxplot_by_year", "pool4L", sep = "_")
if (facet_bool){title <- paste(title, "_facet")}
title <- paste(title, "png", sep = ".")
if (facet_bool){
data %>%
filter(!is.na(!!sym(var_str))) %>%
ggplot(aes(x = year, y = !!sym(var_str), group = year)) +
geom_boxplot() +
facet_wrap(~ Stratum, nrow = 2)
} else {
data %>%
filter(!is.na(!!sym(var_str))) %>%
ggplot(aes(x = year, y = !!sym(var_str), group = year)) +
geom_boxplot()
}
ggsave(title)
}
sapply(c("TN", "TURB", "SS", "CHLcal"), plotter_box_by_year, water_4L, T)
plotter_box_by_year("VEL", water_4L, F)
ggsave("VEL_boxplot_by_year_pool4L")
plotter_box_by_year("VEL", water_4L, F)
ggsave("VEL_boxplot_by_year_pool4L.png")
plotter_box_by_year("VEL", water_4L, T)
ggsave("VEL_boxplot_by_year_pool4L_facet.png")
sapply(c("TP", "TN", "TURB", "SS", "CHLcal"), plotter_box_by_year, water_4L, F)
sapply(c("TP", "TN", "TURB", "SS", "CHLcal"), plotter_box_by_year, water_4L, T)
